<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>13隻遊戲</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      margin: 20px;
    }
    h1, h2 {
      text-align: center;
      color: #333;
    }
    h1 {
      margin-bottom: 0;
    }
    section {
      margin: 20px auto;
      max-width: 600px;
    }
    label, input, button, select {
      display: block;
      width: 100%;
      margin-bottom: 10px;
      padding: 10px;
      font-size: 16px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
    }
    th {
      background: #f4f4f4;
    }
    .total-row td {
      background-color: #dff0d8;
      font-weight: bold;
      color: green;
    }
    button {
      background: #007bff;
      color: #fff;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>
  <h1>13隻遊戲計分器</h1>

  <section id="page1">
    <h2>選擇玩家數量</h2>
    <label for="player-count">玩家人數</label>
    <select id="player-count">
      <option value="3">3人</option>
      <option value="4">4人</option>
      <option value="5">5人</option>
    </select>
    <button id="go-to-page2">下一步</button>
  </section>

  <section id="page2" style="display:none;">
    <h2>輸入玩家名稱</h2>
    <form id="player-names-form"></form>
    <button id="go-to-page3">下一步</button>
  </section>

  <section id="page3" style="display:none;">
    <h2>記錄每場積分</h2>
    <form id="score-form">
      <div id="score-inputs"></div>
      <label for="bonus">彩金</label>
      <select id="bonus">
        <option value="A">A</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <!-- 其他選項 -->
      </select>
      <button type="submit">新增本場輸贏</button>
    </form>

    <h2>每場詳細</h2>
    <table>
      <thead id="table-headers"></thead>
      <tbody id="table-body"></tbody>
      <tfoot id="table-footer">
        <tr class="total-row"></tr>
      </tfoot>
    </table>
    <button id="reset-scores">本日輸贏歸零</button>
  </section>

  <script>
    // 切換頁面相關變數
    const page1 = document.getElementById('page1');
    const page2 = document.getElementById('page2');
    const page3 = document.getElementById('page3');

    // 玩家資料相關變數
    const playerCountSelect = document.getElementById('player-count');
    const playerNamesForm = document.getElementById('player-names-form');
    const scoreInputsDiv = document.getElementById('score-inputs');
    const tableHeaders = document.getElementById('table-headers');
    const tableBody = document.getElementById('table-body');
    const tableFooter = document.getElementById('table-footer');

    let players = [];
    let scores = [];

    // 第一頁下一步
    document.getElementById('go-to-page2').addEventListener('click', () => {
      const playerCount = parseInt(playerCountSelect.value);
      playerNamesForm.innerHTML = '';

      for (let i = 0; i < playerCount; i++) {
        const input = document.createElement('input');
        input.type = 'text';
        input.placeholder = `玩家${i + 1}名稱`;
        input.required = true;
        playerNamesForm.appendChild(input);
      }
      page1.style.display = 'none';
      page2.style.display = 'block';
    });

    // 第二頁下一步
    document.getElementById('go-to-page3').addEventListener('click', () => {
      const inputs = playerNamesForm.querySelectorAll('input');
      players = Array.from(inputs).map(input => input.value.trim());
      if (players.includes('')) {
        alert('請輸入所有玩家名稱');
        return;
      }

      // 初始化第三頁
      scoreInputsDiv.innerHTML = '';
      tableHeaders.innerHTML = '<th>場次</th>';
      tableFooter.querySelector('.total-row').innerHTML = `<td>合計</td>`;
      players.forEach(player => {
        const input = document.createElement('input');
        input.type = 'number';
        input.placeholder = `${player}積分`;
        input.required = true;
        scoreInputsDiv.appendChild(input);

        // 表格初始化
        tableHeaders.innerHTML += `<th>${player}</th>`;
        tableFooter.querySelector('.total-row').innerHTML += `<td>0</td>`;
      });

      page2.style.display = 'none';
      page3.style.display = 'block';
    });

    // 記錄積分
    document.getElementById('score-form').addEventListener('submit', e => {
      e.preventDefault();
      const inputs = scoreInputsDiv.querySelectorAll('input');
      const bonus = document.getElementById('bonus').value;

      if (!bonus) {
        alert('請選擇彩金');
        return;
      }

      const currentScores = Array.from(inputs).map(input => parseInt(input.value) || 0);
      scores.push(currentScores);

      // 更新表格
      const row = document.createElement('tr');
      row.innerHTML = `<td>${scores.length}</td>`;
      currentScores.forEach(score => {
        row.innerHTML += `<td>${score}</td>`;
      });
      tableBody.appendChild(row);

      // 更新合計
      const totalCells = tableFooter.querySelector('.total-row').children;
      currentScores.forEach((score, index) => {
        totalCells[index + 1].textContent = parseInt(totalCells[index + 1].textContent) + score;
      });

      // 清空輸入欄位
      inputs.forEach(input => input.value = '');
      document.getElementById('bonus').value = '';
    });

    // 重置積分
    document.getElementById('reset-scores').addEventListener('click', () => {
      scores = [];
      tableBody.innerHTML = '';
      const totalCells = tableFooter.querySelector('.total-row').children;
      for (let i = 1; i < totalCells.length; i++) {
        totalCells[i].textContent = '0';
      }
    });
  </script>
</body>
</html>
